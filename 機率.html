<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç¬¬ä¸€é—œï½œæŠ½çƒä¸æ”¾å›ï¼ˆ3D ç¤ºç¯„å‹•ç•«ï¼‰</title>
<style>
body{
    background:#1b0f33; color:white; font-family:"Noto Sans TC";
    text-align:center; padding:20px;
}
h1{ margin-bottom:20px; }

/* ---------- ä¸» 3D ç®±å­ (Babylon.js) ---------- */
#sceneWrapper{
    margin: 30px auto;
    width: 400px;
    height: 300px;
    position: relative;
}

#babylonCanvas {
    width: 100%;
    height: 100%;
    border: 2px solid #0ff;
    border-radius: 10px;
}

.controls-info {
    position: absolute;
    bottom: -25px;
    left: 0;
    right: 0;
    font-size: 12px;
    color: #0ff;
    opacity: 0.7;
}

/* ---------- é¸é … ---------- */
.option{
    background:#ffcf33; padding:12px; margin:10px auto; width:80%; max-width:300px;
    border-radius:10px; color:#320e00; font-weight:bold; cursor:pointer;
}
.option:hover{ background:#ffe27a; }

.btn{
    margin-top:20px; padding:10px 20px; font-size:18px;
    background:#999; border:none; border-radius:10px; color:#000;
}

/* ---------- é—œéµå­— ---------- */
.keyword{
    color:#00eaff; font-weight:bold; text-decoration:underline;
    cursor:pointer;
}

/* ---------- å´é‚Šèªªæ˜è¦–çª— ---------- */
#infoPanel{
    position:fixed; top:0; right:-350px;
    width:300px; height:100%;
    background:#24104a; padding:20px;
    color:white; transition:0.5s;
    box-shadow:-5px 0 15px rgba(0,0,0,.5);
    z-index: 1000;
}
#closePanel{
    margin-top:10px; cursor:pointer; color:#ffcf33; font-weight:bold;
}

#bagState{
    margin-top:10px; font-size:14px; color:#fffa;
}

/* ---------- 3D ç¤ºç¯„ç®±å­ ---------- */
#demoBox {
    width: 160px; height: 160px;
    margin: 15px auto;
    perspective: 500px;
}
#demoScene {
    width: 120px; height: 120px;
    margin: auto;
    position: relative;
    transform-style: preserve-3d;
    transform: rotateX(-20deg) rotateY(20deg);
    transition: transform 0.3s;
}
.demoFace {
    position: absolute;
    width: 120px; height: 120px;
    background: rgba(255,255,255,0.05);
    border: 1px solid #fffa;
    box-sizing: border-box;
}
.demoFace.front  { transform: translateZ(60px); }
.demoFace.back   { transform: rotateY(180deg) translateZ(60px); }
.demoFace.right  { transform: rotateY(90deg) translateZ(60px); }
.demoFace.left   { transform: rotateY(-90deg) translateZ(60px); }
.demoFace.top    { transform: rotateX(90deg) translateZ(60px); }
.demoFace.bottom { transform: rotateX(-90deg) translateZ(60px); }

.demoBall {
    width: 35px; height: 35px;
    border-radius: 50%;
    position: absolute;
    top: 10px; left: 42px;
    font-size: 26px;
    transition: transform 1s, opacity 0.5s;
}
</style>
<script src="https://cdn.babylonjs.com/babylon.js"></script>
</head>

<body>

<h1>æ©Ÿç‡-ç¬¬ä¸€é—œï¼šæŠ½çƒï¼ˆä¸æ”¾å›ï¼‰</span></h1>

<!-- ä¸» 3D ç®±å­ (Babylon.js) -->
<div id="sceneWrapper">
    <canvas id="babylonCanvas"></canvas>
    
</div>

<h2>é¡Œç›®ï¼š</h2>
<p>
è¢‹ä¸­æœ‰ <b>3 é¡†ç™½çƒã€2 é¡†é»ƒçƒã€1 é¡†è—çƒ</b>ã€‚<br>
æŠ½å…©çƒ<span class="keyword" onclick="openInfo()">ï¼ˆä¸æ”¾å›ï¼‰</span>ï¼Œæ±‚ã€Œç¬¬ä¸€çƒç‚ºç™½ã€ç¬¬äºŒçƒç‚ºé»ƒã€çš„æ©Ÿç‡ï¼Ÿ
</p>

<div class="option" onclick="check(1)">(1) 1/5</div>
<div class="option" onclick="check(2)">(2) 3/15</div>
<div class="option" onclick="check(3)">(3) 3/30</div>

<button class="btn" onclick="location.href='map.html'">è¿”å›åœ°åœ–</button>

<!-- å´é‚Šèªªæ˜ -->
<div id="infoPanel">
    <h3>ğŸ” ä»€éº¼æ˜¯ã€Œä¸æ”¾å›ã€ï¼Ÿ</h3>
    <p>
        æŠ½çƒå¾Œï¼Œ<b>ä¸æœƒæ”¾å›è¢‹å­</b>ã€‚<br>
        æ‰€ä»¥ç¬¬äºŒæ¬¡æŠ½çƒæ™‚ï¼Œè¢‹ä¸­çƒçš„ç¸½æ•¸æœƒè®Šå°‘ï¼
    </p>

    <p>ç¤ºç¯„ï¼šå¾åŸæœ¬è¢‹ä¸­<b>æ‹¿å‡º1å€‹ç™½çƒå’Œ1å€‹é»ƒçƒ</b></p>

    <div id="demoBox">
        <div id="demoScene">
            <div class="demoFace front"></div>
            <div class="demoFace back"></div>
            <div class="demoFace right"></div>
            <div class="demoFace left"></div>
            <div class="demoFace top"></div>
            <div class="demoFace bottom"></div>

            <!-- åŸæœ¬è¢‹ä¸­çš„6å€‹çƒï¼š3ç™½ã€2é»ƒã€1è— -->
            <div id="white1" class="demoBall" style="left: 15px; top: 20px;">âšª</div>
            <div id="white2" class="demoBall" style="left: 50px; top: 15px;">âšª</div>
            <div id="white3" class="demoBall" style="left: 80px; top: 25px;">âšª</div>
            <div id="yellow1" class="demoBall" style="left: 25px; top: 60px;">ğŸŸ¡</div>
            <div id="yellow2" class="demoBall" style="left: 65px; top: 70px;">ğŸŸ¡</div>
            <div id="blue1" class="demoBall" style="left: 45px; top: 45px;">ğŸ”µ</div>
        </div>
    </div>

    <div id="bagState">è¢‹ä¸­ï¼šâšªÃ—3 ğŸŸ¡Ã—2 ğŸ”µÃ—1</div>

    <p id="closePanel" onclick="closeInfo()">é—œé–‰ âœ–</p>
</div>

<script>
// ---------- Babylon.js 3D å ´æ™¯ ----------
const canvas = document.getElementById('babylonCanvas');
const engine = new BABYLON.Engine(canvas, true);

function createTeachingScene() {
    const scene = new BABYLON.Scene(engine);
    
    // ç›¸æ©Ÿè¨­å®š
    const camera = new BABYLON.ArcRotateCamera("camera", -Math.PI/4, Math.PI/3, 8, BABYLON.Vector3.Zero(), scene);
    camera.setTarget(BABYLON.Vector3.Zero());
    // åœ¨æ–°ç‰ˆ Babylon.js ä¸­ï¼Œç›¸æ©Ÿæ§åˆ¶æœƒè‡ªå‹•é™„åŠ åˆ°å ´æ™¯
    // camera.attachControls(canvas);
    
    // å…‰æº
    const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 0.8;
    
    const dirLight = new BABYLON.DirectionalLight("dirLight", new BABYLON.Vector3(-1, -1, -1), scene);
    dirLight.intensity = 0.4;
    
    // å‰µå»ºé€æ˜ç«‹æ–¹é«”å®¹å™¨
    const boxSize = 3;
    const thickness = 0.05;
    
    // ç«‹æ–¹é«”é‚Šæ¡†æè³ª
    const frameMat = new BABYLON.StandardMaterial("frameMat", scene);
    frameMat.wireframe = true;
    frameMat.diffuseColor = new BABYLON.Color3(0, 1, 1); // é’è‰²é‚Šæ¡†
    frameMat.emissiveColor = new BABYLON.Color3(0, 0.3, 0.3);
    
    // ç«‹æ–¹é«”é‚Šæ¡†
    const frame = BABYLON.MeshBuilder.CreateBox("frame", { size: boxSize }, scene);
    frame.material = frameMat;
    
    // é€æ˜ç‰†é¢æè³ª
    const wallMat = new BABYLON.StandardMaterial("wall", scene);
    wallMat.diffuseColor = new BABYLON.Color3(0.2, 0.7, 1);
    wallMat.alpha = 0.1;
    
    // å‰µå»ºå…­é¢ç‰†ï¼ˆå¯é¸ï¼Œå¢åŠ ç«‹é«”æ„Ÿï¼‰
    const walls = [
        { size: [boxSize, thickness, boxSize], pos: [0, -boxSize/2, 0] }, // åº•
        { size: [boxSize, thickness, boxSize], pos: [0, boxSize/2, 0] },  // é ‚
        { size: [thickness, boxSize, boxSize], pos: [-boxSize/2, 0, 0] }, // å·¦
        { size: [thickness, boxSize, boxSize], pos: [boxSize/2, 0, 0] },  // å³
        { size: [boxSize, boxSize, thickness], pos: [0, 0, boxSize/2] },  // å‰
        { size: [boxSize, boxSize, thickness], pos: [0, 0, -boxSize/2] }  // å¾Œ
    ];
    
    walls.forEach((wall, i) => {
        const mesh = BABYLON.MeshBuilder.CreateBox(`wall${i}`, {
            width: wall.size[0],
            height: wall.size[1],
            depth: wall.size[2]
        }, scene);
        mesh.position = new BABYLON.Vector3(...wall.pos);
        mesh.material = wallMat;
    });
    
    // å‰µå»ºçƒé«” - æŒ‰ç…§é¡Œç›®è¦æ±‚ï¼š3ç™½ã€2é»ƒã€1è—
    const ballRadius = 0.15;
    const balls = [];
    
    // çƒé«”ä½ç½®ï¼ˆæ‰‹å‹•è¨­ç½®ä»¥é¿å…é‡ç–Šï¼‰
    const ballPositions = [
        // 3å€‹ç™½çƒ
        [-0.8, -0.5, 0.3],
        [0.6, -0.3, -0.4],
        [-0.2, 0.4, 0.7],
        // 2å€‹é»ƒçƒ
        [0.8, 0.6, 0.2],
        [-0.5, 0.2, -0.6],
        // 1å€‹è—çƒ
        [0.3, -0.7, -0.1]
    ];
    
    const ballColors = [
        // ç™½çƒ
        [1, 1, 1], [1, 1, 1], [1, 1, 1],
        // é»ƒçƒ
        [1, 1, 0.2], [1, 1, 0.2],
        // è—çƒ
        [0.2, 0.4, 1]
    ];
    
    for (let i = 0; i < 6; i++) {
        const ball = BABYLON.MeshBuilder.CreateSphere(`ball${i}`, { diameter: ballRadius * 2 }, scene);
        ball.position = new BABYLON.Vector3(...ballPositions[i]);
        
        const mat = new BABYLON.StandardMaterial(`ballMat${i}`, scene);
        mat.diffuseColor = new BABYLON.Color3(...ballColors[i]);
        mat.specularColor = new BABYLON.Color3(0.3, 0.3, 0.3);
        ball.material = mat;
        
        balls.push(ball);
    }
    
    // æ·»åŠ æ—‹è½‰å‹•ç•«
    let rotationSpeed = 0;
    scene.registerBeforeRender(() => {
        rotationSpeed += 0.002;
        frame.rotation.y = rotationSpeed * 0.5;
        
        // è¼•å¾®æ™ƒå‹•çƒé«”
        balls.forEach((ball, i) => {
            ball.position.y += Math.sin(rotationSpeed * 2 + i) * 0.001;
        });
    });
    
    return scene;
}

const teachingScene = createTeachingScene();

engine.runRenderLoop(() => {
    teachingScene.render();
});

window.addEventListener('resize', () => {
    engine.resize();
});

// ---------- å´é‚Šç¤ºç¯„å‹•ç•« ----------
function openInfo(){
    document.getElementById("infoPanel").style.right = "0";

    // é‡ç½®æ‰€æœ‰çƒçš„ä½ç½®å’Œé€æ˜åº¦
    const allBalls = ['white1', 'white2', 'white3', 'yellow1', 'yellow2', 'blue1'];
    allBalls.forEach(ballId => {
        const ball = document.getElementById(ballId);
        if (ball) {
            ball.style.transform = "translate3d(0px,0px,0px)";
            ball.style.opacity = 1;
        }
    });

    const bag = document.getElementById("bagState");
    bag.textContent = "è¢‹ä¸­ï¼šâšªÃ—3 ğŸŸ¡Ã—2 ğŸ”µÃ—1 (åŸå§‹ç‹€æ…‹)";

    // ç¬¬ä¸€æ­¥ï¼šæ‹¿å‡º1å€‹ç™½çƒ (white3)
    setTimeout(()=>{
        const white3 = document.getElementById("white3");
        if (white3) {
            white3.style.transform = "translate3d(0px,-100px,60px)";
            white3.style.opacity = 0.2;
        }
        bag.textContent = "è¢‹ä¸­ï¼šâšªÃ—2 ğŸŸ¡Ã—2 ğŸ”µÃ—1";
    }, 1000);

    // ç¬¬äºŒæ­¥ï¼šæ‹¿å‡º1å€‹é»ƒçƒ (yellow2)
    setTimeout(()=>{
        const yellow2 = document.getElementById("yellow2");
        if (yellow2) {
            yellow2.style.transform = "translate3d(0px,-100px,60px)";
            yellow2.style.opacity = 0.2;
        }
        bag.textContent = "è¢‹ä¸­ï¼šâšªÃ—2 ğŸŸ¡Ã—1 ğŸ”µÃ—1 (æœ€çµ‚ç‹€æ…‹)";
    }, 2500);
}

function closeInfo(){
    document.getElementById("infoPanel").style.right = "-350px";
}

// ---------- æª¢æŸ¥ç­”æ¡ˆ ----------
function check(n){
    if(n===1){
        alert('ç­”å°äº†ï¼å‰å¾€ç¬¬äºŒé—œï¼');
        localStorage.setItem("stage1","cleared");
        location.href='stage2.html';
    }else{
        alert('ç­”éŒ¯äº†ï¼Œå†è©¦ä¸€æ¬¡ï¼');
    }
}
</script>

</body>
</html>