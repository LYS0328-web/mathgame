<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç¬¬ä¸€é—œï½œæŠ½çƒä¸æ”¾å›ï¼ˆ3D ç¤ºç¯„å‹•ç•«ï¼‰</title>
<style>
body{
    background:#1b0f33; color:white; font-family:"Noto Sans TC";
    text-align:center; padding:20px;
}
h1{ margin-bottom:20px; }

/* ---------- ä¸» 3D ç®±å­ (Babylon.js) ---------- */
#sceneWrapper{
    margin: 30px auto;
    width: 400px;
    height: 300px;
    position: relative;
}

#babylonCanvas {
    width: 100%;
    height: 100%;
    border: 2px solid #0ff;
    border-radius: 10px;
}

.controls-info {
    position: absolute;
    bottom: -25px;
    left: 0;
    right: 0;
    font-size: 12px;
    color: #0ff;
    opacity: 0.7;
}

/* ---------- é¸é … ---------- */
.option{
    background:#ffcf33; padding:12px; margin:10px auto; width:80%; max-width:300px;
    border-radius:10px; color:#320e00; font-weight:bold; cursor:pointer;
}
.option:hover{ background:#ffe27a; }

.btn{
    margin-top:20px; padding:10px 20px; font-size:18px;
    background:#999; border:none; border-radius:10px; color:#000;
}

/* ---------- é—œéµå­— ---------- */
.keyword{
    color:#00eaff; font-weight:bold; text-decoration:underline;
    cursor:pointer;
}

/* ---------- å´é‚Šèªªæ˜è¦–çª— ---------- */
#infoPanel{
    position:fixed; top:0; right:-350px;
    width:300px; height:100%;
    background:#24104a; padding:20px;
    color:white; transition:0.5s;
    box-shadow:-5px 0 15px rgba(0,0,0,.5);
    z-index: 1000;
}
#closePanel{
    margin-top:10px; cursor:pointer; color:#ffcf33; font-weight:bold;
}

#bagState{
    margin-top:10px; font-size:14px; color:#fffa;
}

/* ---------- 3D ç¤ºç¯„ç®±å­ ---------- */
#demoBox {
    width: 160px; height: 160px;
    margin: 15px auto;
    perspective: 500px;
}
#demoScene {
    width: 120px; height: 120px;
    margin: auto;
    position: relative;
    transform-style: preserve-3d;
    transform: rotateX(-20deg) rotateY(20deg);
    transition: transform 0.3s;
}
.demoFace {
    position: absolute;
    width: 120px; height: 120px;
    background: rgba(255,255,255,0.05);
    border: 1px solid #fffa;
    box-sizing: border-box;
}
.demoFace.front  { transform: translateZ(60px); }
.demoFace.back   { transform: rotateY(180deg) translateZ(60px); }
.demoFace.right  { transform: rotateY(90deg) translateZ(60px); }
.demoFace.left   { transform: rotateY(-90deg) translateZ(60px); }
.demoFace.top    { transform: rotateX(90deg) translateZ(60px); }
.demoFace.bottom { transform: rotateX(-90deg) translateZ(60px); }

.demoBall {
    width: 25px; height: 25px;
    border-radius: 50%;
    position: absolute;
    top: 10px; left: 42px;
    font-size: 18px;
    transition: transform 1s, opacity 0.5s;
}
</style>
<script src="https://cdn.babylonjs.com/babylon.js"></script>
</head>

<body>
<h1>æ’åˆ—çµ„åˆ-ç¬¬ä¸€é—œï¼šæŠ½çƒï¼ˆä¸æ”¾å›ï¼‰</span> </h1>


<div id="sceneWrapper">
    <canvas id="babylonCanvas"></canvas>
</div>

<h2>é¡Œç›®ï¼š</h2>
<p>
è¢‹ä¸­æœ‰ <b>ç´…ã€è—ã€ç¶ ã€é»ƒå„ 3 é¡†</b>ã€‚<br>
é€£æŠ½å…©çƒ<span class="keyword" onclick="openInfo()">ï¼ˆä¸æ”¾å›ï¼‰</span>ï¼Œæ±‚ã€Œå…©é¡†çƒé¡è‰²ä¸åŒã€çš„æ’åˆ—çµ„åˆï¼Ÿ
</p>

<div class="option" onclick="check(1)">(1) å››ç¨®å£å‘³çš„ç³–æœå„ 3 é¡†ï¼Œä½ æ¯æ¬¡æŠ½å–çš†ä¸æ”¾å›ï¼Œæƒ³çŸ¥é“å…©é¡†æ˜¯å¦ç‚ºä¸åŒå£å‘³ã€‚</div>
<div class="option" onclick="check(2)">(2) å››ç¨®å£å‘³çš„ç³–æœå„ 3 é¡†ï¼Œä½ é€£çºŒæ‹¿å…©é¡†ï¼Œä½†æ¯æ‹¿ä¸€é¡†å¾Œéƒ½æ”¾å›å†é‡æ–°æŠ½ï¼Œæƒ³çŸ¥é“å…©æ¬¡æ˜¯å¦æœƒæŠ½åˆ°ä¸åŒå£å‘³ã€‚</div>
<div class="option" onclick="check(3)">(3) è¢‹å­è£¡çš„ç³–æœæœ‰å››ç¨®å£å‘³ï¼Œä½†æ•¸é‡ä¸å‡ï¼Œæœ‰çš„åªæœ‰ 1 é¡†ï¼Œæœ‰çš„æœ‰ 5 é¡†ã€‚ä½ å¾é€™è¢‹ç³–æœè£¡é€£æŠ½å…©é¡†ä¸”ä¸æ”¾å›ï¼Œæƒ³çŸ¥é“å…©é¡†æ˜¯å¦ä¸åŒå£å‘³ã€‚</div>

<button class="btn" onclick="location.href='map.html'">è¿”å›åœ°åœ–</button>

<!-- å´é‚Šèªªæ˜ -->
<div id="infoPanel">
    <h3>ğŸ” ä»€éº¼æ˜¯ã€Œä¸æ”¾å›ã€ï¼Ÿ</h3>
    <p>
        æŠ½çƒå¾Œï¼Œ<b>ä¸æœƒæ”¾å›è¢‹å­</b>ã€‚<br>
        æ‰€ä»¥ç¬¬äºŒæ¬¡æŠ½çƒæ™‚ï¼Œè¢‹ä¸­çƒçš„ç¸½æ•¸æœƒè®Šå°‘ï¼
    </p>

    <p>ç¤ºç¯„ï¼šå¾è¢‹ä¸­æ‹¿å‡º<b>1 é¡†ç´…çƒå’Œ 1 é¡†è—çƒ</b></p>

    <div id="demoBox">
        <div id="demoScene">
            <div class="demoFace front"></div>
            <div class="demoFace back"></div>
            <div class="demoFace right"></div>
            <div class="demoFace left"></div>
            <div class="demoFace top"></div>
            <div class="demoFace bottom"></div>

            <!-- åŸæœ¬è¢‹ä¸­çš„12å€‹çƒï¼šç´…ã€è—ã€ç¶ ã€é»ƒå„3 -->
            <div id="red1" class="demoBall" style="background:red; left:10px; top:10px;"></div>
            <div id="red2" class="demoBall" style="background:red; left:40px; top:15px;"></div>
            <div id="red3" class="demoBall" style="background:red; left:70px; top:20px;"></div>

            <div id="blue1" class="demoBall" style="background:blue; left:20px; top:50px;"></div>
            <div id="blue2" class="demoBall" style="background:blue; left:50px; top:55px;"></div>
            <div id="blue3" class="demoBall" style="background:blue; left:80px; top:60px;"></div>

            <div id="green1" class="demoBall" style="background:green; left:10px; top:100px;"></div>
            <div id="green2" class="demoBall" style="background:green; left:40px; top:105px;"></div>
            <div id="green3" class="demoBall" style="background:green; left:70px; top:110px;"></div>

            <div id="yellow1" class="demoBall" style="background:yellow; left:20px; top:140px;"></div>
            <div id="yellow2" class="demoBall" style="background:yellow; left:50px; top:145px;"></div>
            <div id="yellow3" class="demoBall" style="background:yellow; left:80px; top:150px;"></div>
        </div>
    </div>

    <div id="bagState">è¢‹ä¸­ï¼šğŸ”´Ã—3 ğŸ”µÃ—3 ğŸŸ¢Ã—3 ğŸŸ¡Ã—3</div>

    <p id="closePanel" onclick="closeInfo()">é—œé–‰ âœ–</p>
</div>

<script>
// ---------- Babylon.js 3D å ´æ™¯ ----------
const canvas = document.getElementById('babylonCanvas');
const engine = new BABYLON.Engine(canvas, true);

function createTeachingScene() {
    const scene = new BABYLON.Scene(engine);
    
    const camera = new BABYLON.ArcRotateCamera("camera", -Math.PI/4, Math.PI/3, 10, BABYLON.Vector3.Zero(), scene);
    camera.setTarget(BABYLON.Vector3.Zero());
    
    const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 0.8;
    
    const dirLight = new BABYLON.DirectionalLight("dirLight", new BABYLON.Vector3(-1, -1, -1), scene);
    dirLight.intensity = 0.4;
    
    const boxSize = 3;
    const frameMat = new BABYLON.StandardMaterial("frameMat", scene);
    frameMat.wireframe = true;
    frameMat.diffuseColor = new BABYLON.Color3(0, 1, 1);
    frameMat.emissiveColor = new BABYLON.Color3(0, 0.3, 0.3);
    
    const frame = BABYLON.MeshBuilder.CreateBox("frame", { size: boxSize }, scene);
    frame.material = frameMat;

    const wallMat = new BABYLON.StandardMaterial("wall", scene);
    wallMat.diffuseColor = new BABYLON.Color3(0.2, 0.7, 1);
    wallMat.alpha = 0.1;
    
    const walls = [
        { size: [boxSize, 0.05, boxSize], pos: [0, -boxSize/2, 0] },
        { size: [boxSize, 0.05, boxSize], pos: [0, boxSize/2, 0] },
        { size: [0.05, boxSize, boxSize], pos: [-boxSize/2, 0, 0] },
        { size: [0.05, boxSize, boxSize], pos: [boxSize/2, 0, 0] },
        { size: [boxSize, boxSize, 0.05], pos: [0, 0, boxSize/2] },
        { size: [boxSize, boxSize, 0.05], pos: [0, 0, -boxSize/2] }
    ];
    
    walls.forEach((w, i) => {
        const mesh = BABYLON.MeshBuilder.CreateBox(`wall${i}`, { width:w.size[0], height:w.size[1], depth:w.size[2] }, scene);
        mesh.position = new BABYLON.Vector3(...w.pos);
        mesh.material = wallMat;
    });
    
    const ballRadius = 0.15;
    const balls = [];
    const colors = [
        [1,0.2,0.2],[1,0.2,0.2],[1,0.2,0.2],
        [0.3,0.5,1],[0.3,0.5,1],[0.3,0.5,1],
        [0.3,1,0.3],[0.3,1,0.3],[0.3,1,0.3],
        [1,1,0.4],[1,1,0.4],[1,1,0.4]
    ];
    
    const positions = [
        [-1,-1,1], [0,-1,1], [1,-1,1],
        [-1,-0.5,0], [0,-0.5,0], [1,-0.5,0],
        [-1,0.5,-1], [0,0.5,-1], [1,0.5,-1],
        [-1,1,0.5], [0,1,0.5], [1,1,0.5]
    ];
    
    for(let i=0;i<12;i++){
        const ball = BABYLON.MeshBuilder.CreateSphere(`ball${i}`, {diameter:ballRadius*2}, scene);
        ball.position = new BABYLON.Vector3(...positions[i]);
        const mat = new BABYLON.StandardMaterial(`ballMat${i}`, scene);
        mat.diffuseColor = new BABYLON.Color3(...colors[i]);
        mat.specularColor = new BABYLON.Color3(0.3,0.3,0.3);
        ball.material = mat;
        balls.push(ball);
    }
    
    let rotationSpeed=0;
    scene.registerBeforeRender(()=>{
        rotationSpeed+=0.002;
        frame.rotation.y = rotationSpeed*0.5;
        balls.forEach((ball,i)=>{
            ball.position.y += Math.sin(rotationSpeed*2+i)*0.001;
        });
    });
    
    return scene;
}

const teachingScene = createTeachingScene();
engine.runRenderLoop(()=>{ teachingScene.render(); });
window.addEventListener('resize',()=>{ engine.resize(); });

// ---------- å´é‚Šç¤ºç¯„å‹•ç•« ----------
function openInfo(){
    document.getElementById("infoPanel").style.right = "0";
    const ballIds = [
        'red1','red2','red3','blue1','blue2','blue3','green1','green2','green3','yellow1','yellow2','yellow3'
    ];
    ballIds.forEach(id=>{
        const ball=document.getElementById(id);
        if(ball){ ball.style.transform="translate3d(0px,0px,0px)"; ball.style.opacity=1; }
    });
    const bag=document.getElementById("bagState");
    bag.textContent="è¢‹ä¸­ï¼šğŸ”´Ã—3 ğŸ”µÃ—3 ğŸŸ¢Ã—3 ğŸŸ¡Ã—3 (åŸå§‹ç‹€æ…‹)";
    
    // ç¬¬ä¸€æ­¥ï¼šæ‹¿å‡º1å€‹ç´…çƒ
    setTimeout(()=>{
        const red1=document.getElementById('red1');
        if(red1){ red1.style.transform="translate3d(0px,-100px,60px)"; red1.style.opacity=0.2; }
        bag.textContent="è¢‹ä¸­ï¼šğŸ”´Ã—2 ğŸ”µÃ—3 ğŸŸ¢Ã—3 ğŸŸ¡Ã—3";
    },1000);
    
    // ç¬¬äºŒæ­¥ï¼šæ‹¿å‡º1å€‹è—çƒ
    setTimeout(()=>{
        const blue1=document.getElementById('blue1');
        if(blue1){ blue1.style.transform="translate3d(0px,-100px,60px)"; blue1.style.opacity=0.2; }
        bag.textContent="è¢‹ä¸­ï¼šğŸ”´Ã—2 ğŸ”µÃ—2 ğŸŸ¢Ã—3 ğŸŸ¡Ã—3 (æœ€çµ‚ç‹€æ…‹)";
    },2500);
}

function closeInfo(){
    document.getElementById("infoPanel").style.right="-350px";
}

// ---------- æª¢æŸ¥ç­”æ¡ˆ ----------
function check(n){
    if(n===1){
        alert('ç­”å°äº†ï¼å‰å¾€ç¬¬äºŒé—œï¼');
        localStorage.setItem("stage1","cleared");
        location.href='æ©Ÿç‡.html';
    }else{
        alert('ç­”éŒ¯äº†ï¼Œå†è©¦ä¸€æ¬¡ï¼');
    }
}
</script>

</body>
</html>
